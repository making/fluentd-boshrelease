<source>
  type tail

  # Parse the timestamp, but still collect the entire line as 'message'
  format /^(?<message>(?<time>[^ ]*\s*[^ ]* [^ ]*) .*)$/

  path /var/log/syslog
  pos_file /var/vcap/sys/run/fluentd/pos/syslog.pos
  read_from_head true
  format syslog
  tag syslogfile
</source>

<% if p('in_syslog.enabled') %>
<source>
  @type syslog
  port <%= p('in_syslog.port') %>
  bind 0.0.0.0
  tag <%= p('in_syslog.tag') %>
  protocol_type <%= p('in_syslog.protocol_type') %>
  message_format <%= p('in_syslog.message_format') %>
</source>
<% end %>